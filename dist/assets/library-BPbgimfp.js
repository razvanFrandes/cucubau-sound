import{r as n,b,j as e,R as P,d as A}from"./index-DvoTy1Zf.js";const o={Folder:()=>e.jsx("svg",{width:"16",height:"16",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M2 4a1 1 0 0 1 1-1h3.5l2 2H13a1 1 0 0 1 1 1v6a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V4z"})}),FolderOpen:()=>e.jsx("svg",{width:"48",height:"48",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M6 12a3 3 0 0 1 3-3h10.5l6 6H39a3 3 0 0 1 3 3v18a3 3 0 0 1-3 3H9a3 3 0 0 1-3-3V12z"})}),ChevronRight:()=>e.jsx("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("polyline",{points:"5 2 11 7 5 12"})}),Search:()=>e.jsxs("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"6",cy:"6",r:"4"}),e.jsx("line",{x1:"14",y1:"14",x2:"9",y2:"9"})]}),Music:()=>e.jsxs("svg",{width:"12",height:"12",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{d:"M9 11V3l-6 2v6"}),e.jsx("circle",{cx:"3",cy:"11",r:"2"}),e.jsx("circle",{cx:"9",cy:"9",r:"2"})]}),Trash:()=>e.jsxs("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("polyline",{points:"2 4 12 4"}),e.jsx("path",{d:"M10 4v8a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1V4"}),e.jsx("path",{d:"M5 4V3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v1"})]}),Edit:()=>e.jsx("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:e.jsx("path",{d:"M10.5 1.5a2.121 2.121 0 1 1 3 3L5 13l-4 1 1-4 8.5-8.5z"})}),Scissors:()=>e.jsxs("svg",{width:"14",height:"14",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("circle",{cx:"4",cy:"4",r:"2"}),e.jsx("circle",{cx:"4",cy:"10",r:"2"}),e.jsx("path",{d:"M12 4L5.5 7.5M5.5 6.5L12 10"})]})},q=a=>{const i=Math.floor(a/60),d=Math.floor(a%60);return`${i.toString().padStart(2,"0")}:${d.toString().padStart(2,"0")}`},Q=a=>{const i=new Date(a),d=i.getDate().toString().padStart(2,"0"),u=["jan.","feb.","mar.","apr.","may","jun.","jul.","aug.","sep.","oct.","nov.","dec."][i.getMonth()],m=i.getHours().toString().padStart(2,"0"),p=i.getMinutes().toString().padStart(2,"0");return`${d} ${u}, ${m}:${p}`},z=a=>a<1024?`${a} B`:a<1024*1024?`${(a/1024).toFixed(1)} KB`:`${(a/(1024*1024)).toFixed(1)} MB`;function U(){const[a,i]=n.useState(!1),[d,h]=n.useState(!1),[u,m]=n.useState(!1),[p,g]=n.useState(null),[N,E]=n.useState([]),[x,$]=n.useState([]),[v,S]=n.useState(new Set(["uncategorized"])),[k,I]=n.useState(""),[j,B]=n.useState(0),[f,D]=n.useState("");n.useEffect(()=>{async function t(){const s=await b().initialize();if(!s.success){s.error.type==="NO_FOLDER_SELECTED"||s.error.type==="PERMISSION_PROMPT_NEEDED"?h(!0):g(`Storage error: ${s.error.type}`);return}w(),i(!0)}t()},[]);const w=n.useCallback(async()=>{const t=b();E(t.getFolders()),$(t.getRecordings().sort((s,c)=>c.timestamp-s.timestamp));const r=await chrome.storage.local.get("expandedFolders");r.expandedFolders&&S(new Set(r.expandedFolders))},[]),W=async()=>{m(!0),g(null);try{const r=await b().initialize();r.success?(h(!1),w(),i(!0)):g(`Failed: ${r.error.type}`)}catch{g("Failed to select folder")}finally{m(!1)}};if(d)return e.jsx("div",{className:"min-h-screen bg-[var(--bg-primary)] text-[var(--text-primary)] flex items-center justify-center",children:e.jsxs("div",{className:"text-center p-8",children:[e.jsx("div",{className:"w-20 h-20 mx-auto rounded-2xl bg-[var(--bg-tertiary)] flex items-center justify-center mb-6 text-[var(--accent-cyan)]",children:e.jsx(o.FolderOpen,{})}),e.jsx("h2",{className:"text-xl font-bold mb-3",children:"CucuBau Library"}),e.jsx("p",{className:"text-sm text-[var(--text-secondary)] mb-6 max-w-[320px]",children:"Select your recordings folder to view and manage your library."}),e.jsx("button",{onClick:W,disabled:u,className:"btn bg-[var(--accent-cyan)] text-[var(--bg-primary)] px-6 py-3 text-sm font-semibold rounded-lg",children:u?"Selecting...":"Choose Folder"}),p&&e.jsx("p",{className:"mt-4 text-xs text-[var(--accent-red)]",children:p})]})});if(!a)return e.jsx("div",{className:"min-h-screen bg-[var(--bg-primary)] text-[var(--text-primary)] flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-8 h-8 border-2 border-[var(--accent-cyan)] border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-[var(--text-muted)]",children:"Loading library..."})]})});const O=[...new Set(x.map(t=>t.hostname).filter(Boolean))],T=x.filter(t=>{if(t.parentId)return!1;const r=k.toLowerCase(),s=!r||(t.tabTitle||"").toLowerCase().includes(r)||(t.hostname||"").toLowerCase().includes(r)||(t.tags||[]).some(l=>l.toLowerCase().includes(r)),c=j===0||(t.rating||0)===j,y=!f||t.hostname===f;return s&&c&&y}),F=t=>T.filter(r=>r.folderId===t),_=t=>x.filter(r=>r.parentId===t),L=t=>{S(r=>{const s=new Set(r);return s.has(t)?s.delete(t):s.add(t),chrome.storage.local.set({expandedFolders:Array.from(s)}),s})},H=x.reduce((t,r)=>t+(r.size||0),0),C=(t,r=!1)=>{const s=_(t.id),c=s.length>0;return e.jsx("div",{className:`${r?"ml-6 border-l-2 border-[var(--border-color)]":""}`,children:e.jsxs("div",{className:"group flex items-center gap-3 px-4 py-3 hover:bg-[var(--bg-tertiary)] cursor-pointer transition-all",children:[c&&e.jsx("button",{className:"p-0.5 text-[var(--text-muted)] hover:text-[var(--text-primary)]",children:e.jsx(o.ChevronRight,{})}),t.color&&e.jsx("span",{className:"w-2.5 h-2.5 rounded-full flex-shrink-0",style:{backgroundColor:t.color}}),r&&e.jsx("span",{className:"text-[var(--text-muted)]",children:e.jsx(o.Scissors,{})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"text-sm truncate text-[var(--text-primary)] flex items-center gap-2",children:[t.tabTitle||"Untitled",t.rating&&t.rating>0&&e.jsx("span",{className:"text-[#facc15] text-[10px]",children:"★".repeat(t.rating)}),c&&e.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 rounded bg-[var(--bg-tertiary)] text-[var(--accent-cyan)]",children:[s.length," crop",s.length>1?"s":""]})]}),e.jsxs("div",{className:"text-[10px] text-[var(--text-muted)] flex items-center gap-1.5 mt-0.5",children:[e.jsx(o.Music,{}),t.duration>0&&e.jsx("span",{children:q(t.duration)}),e.jsx("span",{className:"opacity-50",children:"•"}),e.jsx("span",{children:Q(t.timestamp)}),e.jsx("span",{className:"opacity-50",children:"•"}),e.jsx("span",{children:z(t.size)}),t.bpm&&e.jsxs("span",{className:"text-[var(--accent-cyan)]",children:[t.bpm," BPM"]}),t.key&&e.jsx("span",{className:"text-[var(--accent-purple)]",children:t.key})]})]}),e.jsx("button",{className:"opacity-0 group-hover:opacity-100 p-1 text-[var(--text-muted)] hover:text-[var(--accent-cyan)]",children:e.jsx(o.Edit,{})}),e.jsx("button",{className:"opacity-0 group-hover:opacity-100 p-1 text-[var(--text-muted)] hover:text-[var(--accent-red)]",children:e.jsx(o.Trash,{})})]})},t.id)},R=(t,r=0)=>{const s=v.has(t.id),c=F(t.id),y=N.filter(l=>l.parentId===t.id);return e.jsxs("div",{children:[e.jsxs("div",{onClick:()=>L(t.id),className:"group flex items-center gap-2 px-4 py-2 hover:bg-[var(--bg-tertiary)] cursor-pointer",style:{paddingLeft:`${16+r*16}px`},children:[e.jsx("span",{className:`transition-transform ${s?"rotate-90":""}`,children:e.jsx(o.ChevronRight,{})}),e.jsx("span",{className:"w-2 h-2 rounded-full",style:{backgroundColor:t.color}}),e.jsx("span",{className:"text-[var(--text-muted)]",children:e.jsx(o.Folder,{})}),e.jsx("span",{className:"flex-1 text-sm font-medium truncate",children:t.name}),e.jsx("span",{className:"text-[10px] text-[var(--text-muted)] bg-[var(--bg-tertiary)] px-2 py-0.5 rounded-full",children:c.length})]}),s&&e.jsxs("div",{children:[y.map(l=>R(l,r+1)),c.map(l=>C(l))]})]},t.id)},V=N.filter(t=>t.parentId===null),M=F("uncategorized");return e.jsxs("div",{className:"min-h-screen bg-[var(--bg-primary)] text-[var(--text-primary)]",children:[e.jsx("div",{className:"noise-overlay"}),e.jsx("div",{className:"sticky top-0 z-10 bg-[var(--bg-primary)] border-b border-[var(--border-color)]",children:e.jsxs("div",{className:"max-w-6xl mx-auto px-6 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-[var(--accent-red)] flex items-center justify-center shadow-[0_0_12px_rgba(255,59,92,0.5)]",children:e.jsx("div",{className:"w-3 h-3 rounded-full bg-white"})}),e.jsx("h1",{className:"text-lg font-bold",children:"CucuBau Library"})]}),e.jsxs("div",{className:"text-sm text-[var(--text-muted)]",children:[x.length," recordings • ",z(H)]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]",children:e.jsx(o.Search,{})}),e.jsx("input",{type:"text",value:k,onChange:t=>I(t.target.value),placeholder:"Search recordings...",className:"w-full pl-9 pr-3 py-2 bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-lg text-sm focus:outline-none focus:border-[var(--accent-cyan)]"})]}),e.jsxs("select",{value:f,onChange:t=>D(t.target.value),className:"px-3 py-2 bg-[var(--bg-tertiary)] border border-[var(--border-color)] rounded-lg text-sm focus:outline-none",children:[e.jsx("option",{value:"",children:"All sites"}),O.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx("div",{className:"flex items-center gap-1",children:[1,2,3,4,5].map(t=>e.jsx("button",{onClick:()=>B(j===t?0:t),className:`text-lg ${j===t?"text-[#facc15]":"text-[var(--text-muted)] hover:text-[#facc15]"}`,children:"★"},t))})]})]})}),e.jsx("div",{className:"max-w-6xl mx-auto px-6 py-4",children:e.jsxs("div",{className:"bg-[var(--bg-secondary)] rounded-xl border border-[var(--border-color)] overflow-hidden",children:[V.map(t=>R(t)),e.jsxs("div",{children:[e.jsxs("div",{onClick:()=>L("uncategorized"),className:"group flex items-center gap-2 px-4 py-2 hover:bg-[var(--bg-tertiary)] cursor-pointer",children:[e.jsx("span",{className:`transition-transform ${v.has("uncategorized")?"rotate-90":""}`,children:e.jsx(o.ChevronRight,{})}),e.jsx("span",{className:"w-2 h-2 rounded-full bg-[var(--text-muted)]"}),e.jsx("span",{className:"text-[var(--text-muted)]",children:e.jsx(o.Folder,{})}),e.jsx("span",{className:"flex-1 text-sm font-medium truncate",children:"Uncategorized"}),e.jsx("span",{className:"text-[10px] text-[var(--text-muted)] bg-[var(--bg-tertiary)] px-2 py-0.5 rounded-full",children:M.length})]}),v.has("uncategorized")&&e.jsx("div",{children:M.map(t=>C(t))})]})]})})]})}P.createRoot(document.getElementById("root")).render(e.jsx(A.StrictMode,{children:e.jsx(U,{})}));
